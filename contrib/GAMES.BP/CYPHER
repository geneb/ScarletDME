*CYPHER IS MASTERMIND BY KEY SIMMS. DUP??
*  MASTERMIND BY KEN SIMMS
     DIM SCORE.RANGE(8),MSG(8)
     GOTO 9998
1    *
     PROMPT ' '
     HEADING ''
     PRINT 'INSTRUCTIONS?':; INPUT T
     IF T EQ 'Y' OR T EQ 'YES' THEN GOSUB 2000
     PRINT 'HIT RETURN TO CONTINUE':
     INPUT T
1000 *
     HEADING ''
     T=TIME()
     GOSUB 10000
     T=TIME()-T
     PRINT 'YOU HAVE DECIPHERED THE CODE! ':
     SCORE=1000-GN*40-T*2
     PRINT 'YOUR SCORE IS ':SCORE
     FOR I = 1 TO 8
       IF SCORE > SCORE.RANGE(I) THEN
         PRINT MSG(I)
         GOTO 7
       END
     NEXT I
7    PRINT
     PRINT 'DO YOU WANT TO TRY AGAIN?':
     INPUT T
     IF T[1,1] = 'N' THEN STOP
     GOTO 1000
*******************************************************
*
*  SETUP
*
******************************************************
10000*
     PRINT
     CODE=''
     FOR I=1 TO 4
       CODE=CODE:RND(6)
     NEXT I
     FOR GN=1 TO 99999
       LOOP
       FLAG=0
       IF 1000-GN*40-(TIME()-T)*2 LE 0 THEN
         PRINT 'YOU LOSE.  THE CODE WAS ':CODE
         GOTO 7
       END
       PRINT 'GUESS #':GN'R##':'? ':
       INPUT GUESS
       FOR I=1 TO 4
         IF GUESS[I,1]<0 OR GUESS[I,1]>5 THEN FLAG=1
       NEXT I
       UNTIL FLAG=0 DO REPEAT
       IF CODE=GUESS THEN RETURN
       EXACT=0; CLOSE=0
       GUESS2=''; CODE2=''
       FOR I=1 TO 4
         IF GUESS[I,1]=CODE[I,1] THEN
           EXACT=EXACT+1
         END ELSE
           GUESS2=GUESS2:GUESS[I,1]
           CODE2=CODE2:CODE[I,1]
         END
       NEXT I
       FOR I=0 TO 5
         IF INDEX(CODE2,I,1)>0 AND INDEX(GUESS2,I,1)>0 THEN CLOSE=CLOSE+1
         IF INDEX(CODE2,I,2)>0 AND INDEX(GUESS2,I,2)>0 THEN CLOSE=CLOSE+1
       NEXT I
       PRINT @(20):CHAR(26):
       FOR IX = 1 TO EXACT
         PRINT 'B':
       NEXT IX
       FOR IX = 1 TO CLOSE
         PRINT 'W':
       NEXT IX
       PRINT
     NEXT GN
******************************************************
2000 *INSTRUCTIONS
     PRINT
     PRINT 'YOUR MISSION IS TO CRACK THE ENEMY CODE.'
     PRINT 'YOU MUST GUESS THE ENEMY CODE NUMBER WHICH IS A '
     PRINT '4 DIGIT NUMBER WHOSE DIGITS ARE FROM 0 TO 5 INCLUSIVE.'
     PRINT 'THE SOONER YOU GUESS THE NUMBER THE BETTER YOUR SCORE.'
     PRINT 'YOU WILL BE TOLD WHEN THE CODE NUMBER YOU GUESS'
     PRINT 'CONTAINS A CORRECT DIGIT IN THE CORRECT LOCATION'
     PRINT 'THIS WILL BE DESIGNATED BY A "B"'
     PRINT 'AND WHEN IT CONTAINS ANY OTHER DIGITS THAT ARE'
     PRINT 'CORRECT BUT IN THE WRONG LOCATION.'
     PRINT 'THIS WILL BE DESIGNATED BY A "W"'
     PRINT 'FOR EXAMPLE: A CODE OF 1123 AND A GUESS OF 2111 YIELDS BWW.'
     PRINT 'B FOR THE 1 IN THE SECOND POSITION.  W FOR THE 2 IN THE'
     PRINT 'FIRST POSITION WHICH SHOULD HAVE BEEN IN THE THIRD.'
     PRINT 'AND W FOR THE 1 IN THE THIRD POSTION WHICH SHOULD HAVE'
     PRINT 'BEEN IN THE FIRST.  THE 1 IN THE FOURTH POSITION PRODUCES'
     PRINT "NO RESPONSE SINCE THERE ARE ONLY TWO 1'S IN THE CODE."
     PRINT 'YOU START WITH 1000 POINTS.  YOU LOSE 40 POINTS FOR EACH'
     PRINT 'INCORRECT GUESS AND 2 POINTS FOR EACH SECOND OF ELAPSED TIME.'
     PRINT
     RETURN
9998 *
     SCORE.RANGE(1)=799
     SCORE.RANGE(2)=699
     SCORE.RANGE(3)=599
     SCORE.RANGE(4)=499
     SCORE.RANGE(5)=399
     SCORE.RANGE(6)=299
     SCORE.RANGE(7)=99
     SCORE.RANGE(8)=-9999
     MSG(1)="THE CIA WILL MAKE YOU AN OFFER YOU CAN'T REFUSE"
     MSG(2)="IF THE CIA DOESN'T MAKE YOU AN OFFER, MOSCOW WILL."
     MSG(3)='007 WILL SOON BE CALLING FOR YOUR ADVICE.'
     MSG(4)="WITH A MIND LIKE YOURS, THE IRS SHOULD AUDIT YOUR TAXES"
     MSG(5)="THE ONLY WAY YOU'D EVER QUALIFY AS A CODE BREAKER IS IF THEY DROPPED THE BOMB ON WASHINGTON."
     MSG(6)="YOU HAVE DEFINITE POTENTIAL... NO TALENT, JUST POTENTIAL."
     MSG(7)="NO ONE IS INTERESTED IN YOUR MIND.  HOW ABOUT SELLING YOUR BODY?"
     MSG(8)="WHY DON'T YOU TRY PLAYING TIC-TAC-TOE?"
     GOTO 1
END
